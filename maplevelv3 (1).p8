pico-8 cartridge // http://www.pico-8.com
version 43
__lua__
-- main game code
-- all the game's core logic is contained here for easy testing.

--! helper function for smooth movement
-- the move function smoothly interpolates a value from 'rx' towards 'mx'
-- 'c' is the speed of the interpolation.
function move(rx,mx,c)
    c=c and c or 0.7
    if abs(rx-mx)<1 then
        return mx
    end
    
    return (1-c)*mx+rx*c
end


function _init()  
    --! palette setup
    -- this sets up your custom color palette for the game.
    poke(0x5f2e, 1) -- enables extra colors
    custom_palette = {[0]=0,1,134,3,4,5,6,7,132,9,10,11,12,133,128,15}
    reset_pal()

    --! camera setup
    -- initializes the camera variables to their starting values.
    cam_x = 0
    cam_y = 0

    --! dummy player setup
    -- creates a simple object to represent the player for testing.
    player = { x = 1, y = 384 }
    
    --! starting camera position
    -- moves the camera to the player's starting position at the beginning.
    cam_y = player.y - 60
    cam_y_bottom = 384
end

--! palette helper function
-- restores the pico-8 default palette then applies your custom one.
function reset_pal()
    pal()
    pal(custom_palette, 1)
end

--! camera update function
-- runs every frame to smoothly follow the player's vertical movement.
function update_camera()
    cam_y = move(player.y - 60, cam_y, 0.2)
    cam_y = min(cam_y, cam_y_bottom)
    cam_x = 0
end

--! main game loop (updates)
function _update()
    --! dummy player movement
    -- lets you move the player with arrow keys for testing the camera.
    if btn(0) then player.x -= 1 end -- left
    if btn(1) then player.x += 1 end -- right
    if btn(2) then player.y -= 1 end -- up
    if btn(3) then player.y += 1 end -- down
    
    update_camera()
end

--! main game loop (draws)
function _draw()
    cls(0) -- clear the screen to black

    -- applies the calculated camera position for drawing the world.
    camera(cam_x, cam_y)

    --! level and player drawing
    -- draw your level map here.
    map(0, 0)
    
    -- draws a simple square for the dummy player.
    rectfill(player.x, player.y, player.x+8, player.y+8, 7)
    
    -- resets the camera to a fixed position for drawing ui elements.
    camera(0, 0)
end
-->8
--camera
--!init_camera() runs once when the game starts.
function init_camera()
    cam_x = 0
    cam_y = 0
    camera(cam_x, cam_y)
end

--!update_camera() runs every frame to follow the player.
function update_camera()
    -- this moves the camera smoothly, keeping the player slightly above the center of the screen.
    -- you can adjust '60' to change the player's vertical position.
    cam_y = move(player.y - 60, cam_y, 0.2)
    
    -- this prevents the camera from scrolling below the starting point.
    cam_y = min(cam_y, cam_y_bottom)
    
    -- the camera in hook mountain is fixed on the x-axis.
    cam_x = 0
end
__gfx__
88888888888888888888888800000000000000000000000066d66d66000000000000000000000000000aa0000000000000000000000000000000000000000000
848444848448844484484448000000000000000000000000dd6dd6dd000000000000000000000000000aa0000000000000000000000000000000000000000000
848888848888444484484448000000000000000000000000dd6dd6dd00000000000000000000000000a00a000000000000000000000000000000000000000000
84844484844488884884884800000000000000000000000066d66d660000000000000000000000000a0000a00000000000000000000000000000000000000000
848444884444444444444488000000000000000000000000dd6dd6dd0000000000000000000000000a0aa0a00000000000000000000000000000000000000000
888444444444444444444848000000000000000000000000dd6dd6dd00000000000000000000000000aaaa000000000000000000000000000000000000000000
84484444444444444444844800000000000000000000000066d66d66000000000000000000000000000000000000000000000000000000000000000000000000
844844444444444444448448000000000000000000000000dd6dd6dd000000000000000000000000000000000000000000000000000000000000000000000000
888844444444444444444848444444444444444400000000dd6dd6dd000000000000000000000000000000000003300000000000000000000000000000000000
84448444444444444444848844774444448448440000000066d66d66000000000000000000000000000000000030030000000000000000000000000000000000
844484444444444444448448447444444444444400000000dd6dd6dd000000000000000000000000000000000330033000000000000000000000000000000000
844484444444444444448448444446644844848400000000dd6dd6dd000000000000000000000000000000000030030000000000000000000000000000000000
84448444444444444444488844447764444444440000000066d66d660000000067cccc7600000000000000000003300000000000000000000000000000000000
844484444444444444448448444677444844484400000000dd6dd6dd000000000cccccc000000000000000000003300000000000000000000000000000000000
888844444444444444448448444664444448444400000000dd6dd6dd0000000000c7660000000000000000000003300000000000000000000000000000000000
84484444444444444444844844444444444444440000000066d66d66000000000000000000000000000000000330033000000000000000000000000000000000
844844444444444444444888000000008888888800000000dd6dd6dd000000000000000000000000000000000000000000000000000000000000000000000000
848844444444444444448448000000008484448400000000dd6dd6dd000000000000000000000000000000000000000000000000000000000000000000000000
84844444444444444444844800000000848888840000000066d66d66000000000000000000000000000000000000000000000000000000000000000000000000
888444444444444444448448000000008484448400000000dd6dd6dd000000000000000000000000000000000000000000000000000000000000000000000000
844488884488848844444888000000008484448800000000dd6dd6dd000000000000000000000000000000000000000000000000000000000000000000000000
84484448488448848888884800000000888444440000000066d66d66000000000000000000000000000000000000000000000000000000000000000000000000
844844484844448448448448000000008448444400000000dd6dd6dd000000000000000000000000000000000000000000000000000000000000000000000000
888888888888888888888888000000008448444400000000dd6dd6dd000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000bb33bbbbbbbbbbbbbbbbbbbbcccccccc00000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000b34433bbb3333bbbbb333333cccccccc00000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000334444333444433333444444cccccccc00000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000444444444444444444444444cccccccc00000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000444444444444444444444444cccccccc00000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000444444444444444444444444cccccccc00000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000444444444444444444444444cccccccc00000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000444444444444444444444444cccccccc00000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
21621162626201216262626262626201000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
21606060101001216060601010106001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
21116161616101216161616161616101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
21626262626201216262626262626201000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
21606060606001216060606060606001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
21614211121212126161611212616101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
21620212216262626262626262626201000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
21606060216060606041606060606001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
21102061216111114131416161616101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
21626262216211626262626262626201000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
21606002226011606011111160606001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
21616161616111616161616101616101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
21626262626211626262626210101001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
21111111110212121212126060606001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
21114111216161616161616161616101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
21311262626262626262626262626201000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
21226060606060606060601010101001535353535353535353535353535353530000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
21616161611010106161616161114101535353535353535353535353535353530000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
21626262626262626262626262621101535353535353535353535353535353530000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
21606060606060601010101060606001535353535353535353535353535353530000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
21616161616161616161616161616101535353535353535353535353535353530000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
21101010101020626262626262626201535353535353535353535353535353530000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
21121212121212226060606060606001535353535353535353535353535353530000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
21616161616161616161616161616101535353535353535353535353535353530000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
21626262626262626262626262626201535353535353535353535353535353530000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
21606060606060604210101010101001535353535353535353535353535353530000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
21616161616161021212121212121201535353535353535353535353535353530000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
21626262626262626262626262626201535353535353535353535353535353530000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
21606060606060606060606060606001535353535353535353535353535353530000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
21616161616161616161616161616101535353535353535353535353535353530000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
21626262626262626262626262626201535353535353535353535353535353530000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
10101010101010101010101010101010535353535353535353535353535353530000000000000000000000000000000000000000000000000000000000000000
__map__
1235353535353535353535333332331000000000003535350000000000000035000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1232333234343535353334111111111000000000003500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1221212121213335353521212121211000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1226262611262626262626262626261000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1206110606061106060606060606061000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1216161616161616161116161616161000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1226262626112626262626262626261000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1206060606060606060606061106061000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1216111616161616161616161616161000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1226262626112626261126262626261000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1206060606060606060606060606061000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1216161616161611161616161116161000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1226261126262626262626262626261000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1206060606060606061106060606061000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1216161616161116161616161616161000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1226262626262626262626262626261000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1216161111161616161616161616161000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1226112626262611262626262626261000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1206110606060611060606060606061000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1216111616161616161616161616161000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1226112626262626262626262626261000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1206110606060606060606060606061000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1216161616111616111616161616161000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1226262626112626262626262626261000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1206060606060606060606060606061000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1216161616161616161616111616161000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1226262626111111112626262626261000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1206060606060606060606061111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1216161611111616161611161611161000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1226262626262626262611262626261000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1206060606061012060611110606061000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1216161616161012161616161616161000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
